<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="notiQnaMapper">

 	<resultMap type="Notice" id="noticeResultMap">
		<id property="noticeNo" column="NOTICE_NO"/>
		<result property="noticeTitle" column="NOTICE_TITLE"/>
		<result property="noticeContent" column="NOTICE_CONTENT"/>
		<result property="noticeCreateDate" column="NOTICE_CREATE_DATE"/>
		<result property="noticeUploadDate" column="NOTICE_UPLOAD_DATE"/>
		<result property="userType" column="USER_TYPE"/>
		<result property="noticePublicYN" column="NOTICE_PUBLIC_YN"/>
	</resultMap>
	
 	<resultMap type="Qna" id="qnaResultMap">
		<id property="qnaNo" column="QNA_NO"/>
		<result property="qnaTitle" column="QNA_TITLE"/>
		<result property="qnaContent" column="QNA_CONTENT"/>
		<result property="qnaWriter" column="QNA_WRITER"/>
		<result property="qanCreateDate" column="QNA_CREATE_DATE"/>
		<result property="qanUploadDate" column="QNA_UPLOAD_DATE"/>
		<result property="boardPublicYN" column="BOARD_PUBLIC_YN"/>
		<result property="userType" column="USER_TYPE"/>
		<result property="userNo" column="USER_NO"/>
		<result property="originNo" column="ORIGIN_NO"/>
		<result property="groupOrder" column="GROUP_ORDER"/>
		<result property="groupLayer" column="GROUP_LAYER"/>
	</resultMap>

	<!-- 공지사항 -->
	<select id="selectNoticePublicAllList" resultMap="noticeResultMap">
		SELECT * FROM NOTICE WHERE NOTICE_PUBLIC_YN = 'Y' ORDER BY NOTICE_NO ASC
	</select>
	
	<select id="selectNoticeOneDetail" resultMap="noticeResultMap">
		SELECT * FROM NOTICE WHERE NOTICE_NO = #{noticeNo}
	</select>
	
	<insert id="insertNotice">
		INSERT INTO "NOTICE" VALUES(SEQ_NOTICE.NEXTVAL, #{noticeTitle}, #{noticeContent}, DEFAULT, DEFAULT, #{userType}, 'Y')
	</insert>
	
	<delete id="deleteNotice">
		DELETE FROM NOTICE WHERE NOTICE_NO = #{noticeNo}
	</delete>
	
	<update id="updateNotice">
		UPDATE NOTICE SET NOTICE_TITLE=#{noticeTitle}, NOTICE_CONTENT=#{noticeContent}, NOTICE_UPLOAD_DATE=SYSDATE  WHERE  NOTICE_NO = #{noticeNo}
	</update>
	
	
	
	<!-- qna -->
	
	<select id="selectQnaListCount" resultType="_int">
		SELECT COUNT(*) FROM QNA_BOARD
	</select>
	
	<select id="selectQnaAllList" resultMap="qnaResultMap">
		SELECT * FROM QNA_BOARD ORDER BY QNA_NO DESC
	</select>
	
	<select id="selectQnaOneDetail" resultMap="qnaResultMap">
		SELECT * FROM QNA_BOARD WHERE QNA_NO = #{qnaNo}
	</select>
	
	<insert id="inserQna" parameterType="Qna">
		INSERT INTO "QNA_BOARD" VALUES(SEQ_QNA.NEXTVAL, #{qnaTitle}, #{qnaContent}, #{qnaWriter}, DEFAULT, DEFAULT, 'N', #{userType}, #{userNo}, SEQ_QNA.CURRVAL, 0, 0)
	</insert>
	
	<delete id="deleteQna">
		DELETE FROM QNA_BOARD WHERE QNA_NO = #{qnaNo}
	</delete>
	
	<update id="updateGroup">
		UPDATE QNA_BOARD
				SET ORIGIN_NO = (SELECT QNA_NO FROM QNA_BOARD WHERE QNA_NO = #{qnaNo} ),
				GROUP_ORDER = (CASE WHEN GROUP_ORDER LIKE 0  THEN 1
				WHEN GROUP_ORDER LIKE 1 THEN 2 END),
				GROUP_LAYER = (CASE WHEN GROUP_LAYER LIKE '0' THEN 1
				WHEN GROUP_LAYER LIKE 1 THEN 2 END)
				WHERE QNA_NO = #{qnaNo}
	</update>
	
	<update id="updateQnA">
		UPDATE QNA_BOARD SET QNA_TITLE = #{qnaTitle}, QNA_CONTENT = #{qnaContent}, QNA_UPLOAD_DATE = SYSDATE WHERE QNA_NO = #{qnaNo}
	</update>


</mapper>